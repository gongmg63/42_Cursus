# Philosophers🧠🍴
이 프로젝트는 **식사하는 철학자 문제(Dining Philosophers Problem)** 를 기반으로 하며 스레드 및 동시성 제어를 학습하고 구현한 프로젝트입니다. 동시성 프로그래밍에서 발생할 수 있는 교착 상태와 경쟁 상태를 다루며 이를 해결하는 다양한 방법을 탐구합니다.

---


## 📚 철학자 문제란?
**식사하는 철학자들 문제**는 전산학에서 동시성과 교착 상태를 설명하는 예시로, 여러 프로세스가 동시에 돌아갈 때 교착 상태가 나타나는 원인을 직관적으로 알 수 있다.


다섯 명의 철학자가 원탁에 앉아 있고, 각자의 앞에는 스파게티가 있고 양옆에 포크가 하나씩 있다. 그리고 각각의 철학자는 다른 철학자에게 말을 할 수 없다. 이때 철학자가 스파게티를 먹기 위해서는 양 옆의 포크를 동시에 들어야 한다. 이때 각각의 철학자가 왼쪽의 포크를 들고 그 다음 오른쪽의 포크를 들어서 스파게티를 먹는 알고리즘을 가지고 있으면, 다섯 철학자는 동시에 왼쪽의 포크를 들 수 있으나 오른쪽의 포크는 이미 가져가진 상태이기 때문에 다섯 명 모두가 무한정 서로를 기다리는 교착 상태에 빠지게 될 수 있다.


또한 어떤 경우에는 동시에 양쪽 포크를 집을 수 없어 식사를 하지 못하는 기아 상태가 발생할 수도 있고, 몇몇 철학자가 다른 철학자보다 식사를 적게 하는 경우가 발생하기도 한다.

---

## 📖프로젝트 설명
C언어 기반 실행파일을 만들어 **`철학자 수` `수명` `먹는 시간` `자는 시간` `[먹는 횟수]`** 를 입력받아 문제가 없는 입력이라면 아무도 죽지않고 식사를 무사히 할 수 있게 하면 됩니다.


## ⚙️실행 방법
```bash
make

./philo "number_of_philosophers" "time_to_die" "time_to_eat" "time_to_sleep" "[number_of_times_each_philosopher_must_eat]"

```


## 🚀 프로젝트 목표
1. **동시성 제어**: 여러 스레드가 자원을 공유할 때 발생할 수 있는 문제를 이해하고 해결.
   - 뮤텍스를 통해(보너스의 경우 세마포어) 스레드간의 임계영역에 대한 접근을 조절해 데이터 레이스가 발생하는 것을 막음.
2. **교착 상태 방지**: 교착 상태를 피하기 위한 대책 도입.
   - 교착 상태를 막기 위해 홀수 철학자와 짝수 철학자의 작업 시작 시간을 엇갈리게 해 최소화 시도.

---
## ✒️느낀점
- 프로세스 스레딩에 익숙치 않았지만, 먼저 사용할 것들에 대해 알아봐야 겠다고 생각했다. `스레드`, `뮤텍스`, `세마포어` 등에대해 찾아보며 발생할 문제에 대해 찾아보며 철학자 문제에 대해 생각해 봤다.
- `철학자`는 **스레드 혹은 프로세스**를, `포크`는 여러 `철학자(스레드)`가 접근 할 수 있다는 관점에서 **공유자원**이라는 생각과 함께 코드를 작성했다.
- 여러 스레드를 관리하다 보니 `컨텍스트 스위칭`이 자주 발생해 그에 따른 시간 손실도 미묘하게 생겼다. 그로인해 원래대로라면 정상적으로 먹을 수 있는 철학자도 먹지못하고 죽는 경우가 발생해 이러한 부분역시 고려해 코드를 짜야한다는 걸 알았다.
- 뿐만 아니라 `usleep`함수 자체에서도 프로그램에 영향을 줄만큼의 차이가 발생한다는 걸 알았다. 그 차이를 메꾸기 위해 400ms의 시간을 잔다면 한번에 400ms을 자는 것이 아닌 50ms씩 쪼개서 자는 식으로 코드를 작성했다.
- 교착상태를 막기위해 홀짝의 투입 시기를 조절했는데, 이 과정에서 전달받은 인자(수명, 먹는 시간, 자는 시간) 중 하나를 사용할 때 극단적인 경우 늦게 투입되는 번호가 아주 긴 시간 잠에들어 문제가 생겼었다. 이러한 예외 역시 처리하며 코드를 짜야겠다.
